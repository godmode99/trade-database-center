# แผนการพัฒนาโครงการ Trade Database Center

> เอกสารนี้ทำหน้าที่เป็นแผนปฏิบัติการหลักของโปรเจค และสอดคล้องกับเป้าหมายใน `เอกสารโครงการ.md` และผลประเมินใน `รายงานประเมินโครงการ.md`

## 1) เป้าหมายเชิงส่งมอบ (Deliverables)
1. มี data pipeline ที่รันได้จริงสำหรับ Calendar, FRED, MT5, CME FedWatch
2. มีโครงสร้างฐานข้อมูลกลางบน Supabase พร้อม data contract ชัดเจน
3. มีหน้าเว็บ Next.js สำหรับดูข้อมูลหลักอย่างน้อย 1 dashboard
4. มีระบบรันงานอัตโนมัติ + logging + การตรวจคุณภาพข้อมูลเบื้องต้น

## 2) ลำดับการพัฒนา (Phase Plan)

### Phase 1: Foundation (สัปดาห์ 1-2)
- [ ] ออกแบบ schema กลางใน Supabase (raw/normalized/features)
- [ ] นิยาม data contract กลาง (field name, type, timezone, key)
- [ ] ย้าย Calendar pipeline จาก ref มาที่ `god project/fetch/calendar`
- [ ] ให้ Calendar รองรับ weekly fetch + refresh actual ได้
- [ ] สร้างชุดทดสอบการรัน pipeline แบบ local

**ผลลัพธ์ที่ต้องได้:** ข้อมูล Calendar ไหลครบ fetch → db → query

### Phase 2: Source Expansion (สัปดาห์ 3-4)
- [ ] พัฒนา FRED pipeline (daily/weekly/monthly)
- [ ] พัฒนา MT5 pipeline (ohlcv + features ที่กำหนด)
- [ ] พัฒนา CME FedWatch pipeline (probabilities + quotes)
- [ ] ทำ upsert strategy และดัชนีที่จำเป็นในแต่ละตาราง

**ผลลัพธ์ที่ต้องได้:** 4 แหล่งข้อมูลเริ่ม ingest เข้าฐานข้อมูลได้

### Phase 3: Web & API (สัปดาห์ 5)
- [ ] วาง query/API layer สำหรับหน้าเว็บ
- [ ] พัฒนา dashboard หน้าแรก (filter ตาม source/timeframe)
- [ ] ทำตาราง Calendar + สถานะ actual และ last update

**ผลลัพธ์ที่ต้องได้:** เว็บแสดงข้อมูลจากฐานข้อมูลจริง ไม่ใช่ template

### Phase 4: Automation & Quality (สัปดาห์ 6)
- [ ] ตั้ง schedule งาน (cron/workflow)
- [ ] เพิ่ม logging มาตรฐานทุก pipeline
- [ ] เพิ่ม data quality checks: missing/stale/outlier
- [ ] สรุป runbook การแก้ปัญหาเมื่อ pipeline ล้มเหลว

**ผลลัพธ์ที่ต้องได้:** พร้อมใช้งานต่อเนื่องในระดับ production เบื้องต้น

## 3) Backlog งานสำคัญ (Priority Backlog)
1. สูง: Calendar pipeline ใช้งานได้จริงในโปรเจคใหม่
2. สูง: Supabase schema v1 + migration script
3. สูง: FRED pipeline daily ก่อน แล้วค่อย weekly/monthly
4. กลาง: หน้า dashboard MVP
5. กลาง: ระบบแจ้งเตือนเมื่อ fetch ล้มเหลว

## 4) ความเสี่ยงและแนวทางลดความเสี่ยง
- ความเสี่ยง: source ภายนอกเปลี่ยนรูปแบบข้อมูล
  - แนวทาง: แยก parser เป็นโมดูล, เพิ่ม validation ก่อนบันทึก
- ความเสี่ยง: schema เปลี่ยนบ่อยช่วงแรก
  - แนวทาง: ใช้ migration versioning และ backward-compatible views
- ความเสี่ยง: งาน scheduled fail แล้วไม่รู้ตัว
  - แนวทาง: บังคับ log + alert ทุก job

## 5) Definition of Done (DoD)
งานแต่ละ source จะถือว่าเสร็จเมื่อ:
1. fetch ได้ตามความถี่ที่กำหนด
2. บันทึกลงตารางที่ออกแบบไว้พร้อม key/upsert ถูกต้อง
3. มี log/manifest ระบุสถานะสำเร็จหรือข้อผิดพลาด
4. เว็บหรือ API อ่านข้อมูลชุดนั้นได้จริง

## 6) อัปเดตล่าสุด
- สร้างเอกสารแผนฉบับแรก โดยอ้างอิงสถานะจากเอกสารประเมินและโค้ด ref ของ calendar/fred pipeline
